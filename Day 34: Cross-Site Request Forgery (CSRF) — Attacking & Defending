âœ… Topic: Cross-Site Request Forgery (CSRF) â€” Attacking & Defending
1) What is CSRF?

CSRF (Cross-Site Request Forgery) is an attack where a victim is tricked into sending a request to a website where they are already logged in.

âœ… The request is made using the victimâ€™s session/cookies, so the website thinks itâ€™s legit.

2) Why CSRF Works

CSRF works because:

Browser automatically attaches cookies

Victim is already authenticated

Server trusts the request only because cookies are present

3) Real Example (Easy to understand)

Victim is logged into bank.com
Attacker makes victim open a malicious page that silently triggers:

â€œTransfer moneyâ€

â€œChange passwordâ€

â€œChange emailâ€

â€œEnable 2FA to attacker deviceâ€

Victim didnâ€™t click â€œconfirmâ€ on bank.com, but browser still sent the request.

4) When CSRF is Dangerous

CSRF is most dangerous when:
âœ… The action is state-changing (POST/PUT/DELETE)
âœ… The app uses cookie-based authentication
âœ… No extra verification exists (OTP / re-auth / token)

5) CSRF vs XSS (Quick Difference)

CSRF: Uses victimâ€™s cookies to force a request

XSS: Runs attacker JS inside victim browser

ğŸ”¥ XSS can sometimes bypass CSRF protections too.

âœ… CSRF Defenses (Must Know)
1) CSRF Token (Best protection)

Server generates a random token and expects it in the request.

âœ… Attacker cannot guess it
âœ… Token must match session/user

Example:

form includes hidden input: csrf_token=...

2) SameSite Cookies

Cookie flags prevent cookies from being sent cross-site.

Recommended:

SameSite=Lax âœ… good default

SameSite=Strict âœ… strongest (but may break UX)

SameSite=None; Secure âœ… needed for cross-site usage

3) Check Origin / Referer Header

Server verifies request came from your domain.

âœ… Useful extra layer
âš ï¸ Not the only layer (headers can be missing sometimes)

4) Require Re-auth / OTP for Critical Actions

For actions like:

changing password

changing email

enabling payments

âœ… confirm via password / OTP / 2FA prompt

5) Avoid GET for State Change

âŒ Wrong:
GET /transfer?to=attacker&amount=5000

âœ… Right:
Use POST + token + confirmation

âœ… Mini Checklist (Interview Ready)

âœ” Cookie-based login? â†’ CSRF risk high
âœ” Token present? â†’ strong protection
âœ” SameSite cookies enabled? â†’ major defense
âœ” Critical actions require OTP? â†’ reduces impact

ğŸ”¥ Key Takeaway

CSRF is not â€œstealing your passwordâ€ â€” itâ€™s forcing actions using your already logged-in session.

âœ… Quick Summary (1 line)

CSRF = attacker makes victimâ€™s browser perform unauthorized actions on a trusted site using existing cookies.
